# 设置功能使用指南

## ✅ 已重新实现

设置功能已完全重新实现，包含以下改进：

### 新特性

1. **更好的 UI/UX**
   - 现代化的界面设计
   - 清晰的状态提示
   - 保存中的加载状态
   - 成功/失败消息提示

2. **改进的错误处理**
   - Tauri API 检查
   - 详细的错误信息
   - 用户友好的提示

3. **更好的用户体验**
   - 显示"未保存"状态
   - 按钮禁用状态管理
   - 自动消失的成功提示

### 如何使用

1. **打开设置窗口**
   - 方式 1: 右键点击系统托盘图标 → 选择"设置"
   - 设置窗口会自动加载当前配置

2. **设置默认工作目录**
   - 点击"浏览"按钮
   - 选择你想要的默认目录
   - 点击"保存设置"

3. **查看当前设置**
   - 打开设置窗口即可看到当前配置的目录
   - 灰色文字显示当前状态

### 技术实现

**文件位置**:
- `/public/settings.html` - 设置页面（被 Vite 提供）
- `/excalidraw-app/settings.html` - 源文件

**开发模式**:
- URL: `http://localhost:3000/settings.html`
- 通过 Vite 开发服务器提供

**生产模式**:
- settings.html 会被打包到构建输出
- 通过 App 协议加载

### 设置存储

设置保存在 JSON 文件中：
- **macOS**: `~/Library/Application Support/com.tauri.dev/settings.json`
- **Windows**: `%APPDATA%/com.tauri.dev/settings.json`
- **Linux**: `~/.config/com.tauri.dev/settings.json`

### 默认值

如果未设置工作目录，系统会使用：
- **macOS/Linux**: `~/Documents`
- **Windows**: `C:\Users\用户名\Documents`

### 故障排除

**设置窗口打不开？**
1. 检查控制台是否有错误
2. 确认 settings.html 在 public 目录
3. 重启应用

**设置无法保存？**
1. 检查选择的目录是否有效
2. 查看错误提示消息
3. 检查文件权限

**设置丢失？**
- 设置存储在本地 JSON 文件
- 删除应用不会删除设置
- 可以手动编辑设置文件

### 测试步骤

1. 启动应用 `cargo tauri dev`
2. 点击托盘图标 → 设置
3. 点击"浏览"选择目录
4. 点击"保存设置"
5. 关闭设置窗口
6. 重新打开设置窗口，确认设置已保存
7. 测试文件打开/保存是否使用新目录

## 界面预览

设置窗口包含：
- 标题：设置
- 输入框：显示当前选择的目录
- 浏览按钮：打开系统文件选择器
- 状态信息：显示当前设置和未保存提示
- 保存按钮：保存设置到本地

## 未来改进

可能的扩展：
- 自动保存设置
- 重置为默认值按钮
- 更多设置选项（主题、快捷键等）
- 导入/导出设置
